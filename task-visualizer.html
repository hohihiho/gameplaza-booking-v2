<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê´‘ì£¼ ê²Œì„í”Œë¼ì - í”„ë¡œì íŠ¸ íƒœìŠ¤í¬ ì‹œê°í™”</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        #network {
            width: 100%;
            height: 600px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
        }
        .task-card {
            transition: all 0.3s ease;
        }
        .task-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-900">
    <div class="container mx-auto px-4 py-8">
        <header class="mb-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">ğŸ® ê´‘ì£¼ ê²Œì„í”Œë¼ì ì˜ˆì•½ ì‹œìŠ¤í…œ</h1>
            <p class="text-gray-600">í”„ë¡œì íŠ¸ íƒœìŠ¤í¬ ê³„íš ë° ì˜ì¡´ì„± ì‹œê°í™”</p>
        </header>

        <!-- í†µê³„ ìš”ì•½ -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
            <div class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-sm font-medium text-gray-500">ì „ì²´ íƒœìŠ¤í¬</h3>
                <p class="text-2xl font-bold text-gray-900" id="totalTasks">0</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-sm font-medium text-gray-500">ë…ë¦½ íƒœìŠ¤í¬</h3>
                <p class="text-2xl font-bold text-green-600" id="independentTasks">0</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-sm font-medium text-gray-500">ì˜ì¡´ì„± ìˆëŠ” íƒœìŠ¤í¬</h3>
                <p class="text-2xl font-bold text-blue-600" id="dependentTasks">0</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow">
                <h3 class="text-sm font-medium text-gray-500">ì˜ˆìƒ ì†Œìš” ì‹œê°„</h3>
                <p class="text-2xl font-bold text-purple-600" id="estimatedTime">0ì¼</p>
            </div>
        </div>

        <!-- ë„¤íŠ¸ì›Œí¬ ê·¸ë˜í”„ -->
        <div class="bg-white p-6 rounded-lg shadow mb-8">
            <h2 class="text-xl font-semibold mb-4">íƒœìŠ¤í¬ ì˜ì¡´ì„± ê·¸ë˜í”„</h2>
            <div id="network"></div>
            <div class="mt-4 flex items-center gap-6 text-sm">
                <div class="flex items-center gap-2">
                    <div class="w-4 h-4 bg-green-500 rounded-full"></div>
                    <span>ë…ë¦½ íƒœìŠ¤í¬</span>
                </div>
                <div class="flex items-center gap-2">
                    <div class="w-4 h-4 bg-blue-500 rounded-full"></div>
                    <span>ì˜ì¡´ì„± ìˆëŠ” íƒœìŠ¤í¬</span>
                </div>
                <div class="flex items-center gap-2">
                    <div class="w-4 h-4 bg-purple-500 rounded-full"></div>
                    <span>í¬ë¦¬í‹°ì»¬ íŒ¨ìŠ¤</span>
                </div>
            </div>
        </div>

        <!-- íƒœìŠ¤í¬ ëª©ë¡ -->
        <div class="bg-white p-6 rounded-lg shadow">
            <h2 class="text-xl font-semibold mb-4">íƒœìŠ¤í¬ ìƒì„¸ ëª©ë¡</h2>
            <div class="grid gap-4" id="taskList">
                <!-- íƒœìŠ¤í¬ ì¹´ë“œê°€ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>

    <script>
        // TaskMaster API í˜¸ì¶œ
        async function fetchTasks() {
            try {
                // ì‹¤ì œë¡œëŠ” APIë¥¼ í˜¸ì¶œí•´ì•¼ í•˜ì§€ë§Œ, ì—¬ê¸°ì„œëŠ” í•˜ë“œì½”ë”©ëœ ë°ì´í„° ì‚¬ìš©
                const tasks = [
                    {
                        id: "e25b783d-b954-42be-a64d-cf3c948b0061",
                        name: "PWA ê¸°ë³¸ ì„¤ì • êµ¬í˜„",
                        description: "Progressive Web App ê¸°ëŠ¥ì„ ìœ„í•œ manifest.json, ì•„ì´ì½˜, service worker êµ¬í˜„",
                        dependencies: [],
                        estimatedDays: 2
                    },
                    {
                        id: "c7b686c6-e075-4160-a4c8-be2a20fce065",
                        name: "ì‹¤ì‹œê°„ ì•Œë¦¼ ì‹œìŠ¤í…œ êµ¬í˜„",
                        description: "Supabase Realtimeê³¼ Web Push APIë¥¼ í™œìš©í•œ ì‹¤ì‹œê°„ ì•Œë¦¼ ì‹œìŠ¤í…œ",
                        dependencies: ["e25b783d-b954-42be-a64d-cf3c948b0061"],
                        estimatedDays: 3
                    },
                    {
                        id: "98393015-913f-4cde-900c-6a67304b4d7f",
                        name: "ëª¨ë°”ì¼ UX ìµœì í™”",
                        description: "99% ëª¨ë°”ì¼ ì‚¬ìš©ìë¥¼ ìœ„í•œ í„°ì¹˜ ì œìŠ¤ì²˜, í•˜ë‹¨ ë„¤ë¹„ê²Œì´ì…˜, ìŠ¤ì¼ˆë ˆí†¤ ë¡œë”©",
                        dependencies: [],
                        estimatedDays: 3
                    },
                    {
                        id: "d40388e6-7fd3-4915-916e-b811b4e2666d",
                        name: "ì´ë¯¸ì§€ ë° ì„±ëŠ¥ ìµœì í™”",
                        description: "WebP í¬ë§· ë³€í™˜, next/image ìµœì í™”, ì»´í¬ë„ŒíŠ¸ ë ˆë²¨ ì½”ë“œ ë¶„í• ",
                        dependencies: [],
                        estimatedDays: 2
                    },
                    {
                        id: "5fa6aa13-1bb2-46dd-8555-b36276ada068",
                        name: "í…ŒìŠ¤íŠ¸ ì¸í”„ë¼ êµ¬ì¶•",
                        description: "Jest ë‹¨ìœ„ í…ŒìŠ¤íŠ¸, React Testing Library, Playwright E2E í…ŒìŠ¤íŠ¸",
                        dependencies: [],
                        estimatedDays: 3
                    },
                    {
                        id: "753e4409-7ce9-4e16-b6c4-855b338f32a8",
                        name: "Supabase í´ë¼ì´ì–¸íŠ¸ í†µí•©",
                        description: "ë¶„ì‚°ëœ Supabase í´ë¼ì´ì–¸íŠ¸ ì¸ìŠ¤í„´ìŠ¤ í†µí•©, ê³µí†µ ì—ëŸ¬ í•¸ë“¤ë§",
                        dependencies: [],
                        estimatedDays: 2
                    },
                    {
                        id: "8aa4c1d2-44a8-41c6-a9b0-869b44492119",
                        name: "ê´€ë¦¬ì UI ë¹Œë” ì¸í„°í˜ì´ìŠ¤",
                        description: "ë“œë˜ê·¸ì•¤ë“œë¡­ ë°©ì‹ì˜ ë…¸ì½”ë“œ ìŠ¤íƒ€ì¼ ê´€ë¦¬ì ì¸í„°í˜ì´ìŠ¤",
                        dependencies: ["98393015-913f-4cde-900c-6a67304b4d7f"],
                        estimatedDays: 4
                    },
                    {
                        id: "0f12e0a6-dbe7-4248-98c2-22964141eba1",
                        name: "ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ ëª¨ë‹ˆí„°ë§",
                        description: "ê´€ë¦¬ìë¥¼ ìœ„í•œ ì‹¤ì‹œê°„ í†µê³„ ëŒ€ì‹œë³´ë“œ",
                        dependencies: ["c7b686c6-e075-4160-a4c8-be2a20fce065"],
                        estimatedDays: 3
                    },
                    {
                        id: "4ae146bc-3405-4d49-8d7a-3545cbf77d81",
                        name: "ë³´ì•ˆ ê°•í™” ë° AI í•„í„°ë§",
                        description: "AI ê¸°ë°˜ ì»¨í…ìŠ¤íŠ¸ ë¶„ì„, RLS ì •ì±… ê²€í† , API ë³´ì•ˆ ê°•í™”",
                        dependencies: [],
                        estimatedDays: 3
                    },
                    {
                        id: "cb37d926-b9a7-4485-9a68-3a028ae53042",
                        name: "ë°°í¬ íŒŒì´í”„ë¼ì¸ ë° ëª¨ë‹ˆí„°ë§",
                        description: "Vercel ìë™ ë°°í¬, GitHub Actions í¬ë¡ ì¡, ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§",
                        dependencies: ["5fa6aa13-1bb2-46dd-8555-b36276ada068"],
                        estimatedDays: 2
                    }
                ];
                return tasks;
            } catch (error) {
                console.error('íƒœìŠ¤í¬ ë¡œë“œ ì‹¤íŒ¨:', error);
                return [];
            }
        }

        // í¬ë¦¬í‹°ì»¬ íŒ¨ìŠ¤ ê³„ì‚°
        function calculateCriticalPath(tasks) {
            const taskMap = new Map(tasks.map(t => [t.id, t]));
            const criticalPath = new Set();
            
            // ê° íƒœìŠ¤í¬ì˜ ìµœëŒ€ ê²½ë¡œ ê¸¸ì´ ê³„ì‚°
            const pathLengths = new Map();
            
            function getPathLength(taskId) {
                if (pathLengths.has(taskId)) return pathLengths.get(taskId);
                
                const task = taskMap.get(taskId);
                if (!task) return 0;
                
                let maxDepLength = 0;
                for (const depId of task.dependencies) {
                    maxDepLength = Math.max(maxDepLength, getPathLength(depId));
                }
                
                const length = maxDepLength + task.estimatedDays;
                pathLengths.set(taskId, length);
                return length;
            }
            
            // ëª¨ë“  íƒœìŠ¤í¬ì˜ ê²½ë¡œ ê¸¸ì´ ê³„ì‚°
            tasks.forEach(task => getPathLength(task.id));
            
            // ìµœëŒ€ ê²½ë¡œ ê¸¸ì´ ì°¾ê¸°
            const maxLength = Math.max(...pathLengths.values());
            
            // í¬ë¦¬í‹°ì»¬ íŒ¨ìŠ¤ ì—­ì¶”ì 
            function traceCriticalPath(taskId, currentLength) {
                if (currentLength === maxLength) {
                    criticalPath.add(taskId);
                }
                
                const task = taskMap.get(taskId);
                if (!task) return;
                
                for (const depId of task.dependencies) {
                    const depLength = pathLengths.get(depId);
                    if (depLength + task.estimatedDays === currentLength) {
                        criticalPath.add(depId);
                        traceCriticalPath(depId, depLength);
                    }
                }
            }
            
            // ìµœëŒ€ ê²½ë¡œë¥¼ ê°€ì§„ íƒœìŠ¤í¬ë¶€í„° ì—­ì¶”ì 
            pathLengths.forEach((length, taskId) => {
                if (length === maxLength) {
                    traceCriticalPath(taskId, length);
                }
            });
            
            return criticalPath;
        }

        // ë„¤íŠ¸ì›Œí¬ ê·¸ë˜í”„ ìƒì„±
        function createNetworkGraph(tasks) {
            const criticalPath = calculateCriticalPath(tasks);
            
            // ë…¸ë“œ ìƒì„±
            const nodes = tasks.map(task => ({
                id: task.id,
                label: task.name,
                title: task.description,
                color: {
                    background: criticalPath.has(task.id) ? '#8b5cf6' : 
                               (task.dependencies.length === 0 ? '#10b981' : '#3b82f6'),
                    border: criticalPath.has(task.id) ? '#7c3aed' : 
                           (task.dependencies.length === 0 ? '#059669' : '#2563eb')
                },
                font: { color: 'white' }
            }));

            // ì—£ì§€ ìƒì„±
            const edges = [];
            tasks.forEach(task => {
                task.dependencies.forEach(depId => {
                    edges.push({
                        from: depId,
                        to: task.id,
                        arrows: 'to',
                        color: criticalPath.has(task.id) && criticalPath.has(depId) ? '#8b5cf6' : '#94a3b8'
                    });
                });
            });

            // ë„¤íŠ¸ì›Œí¬ ìƒì„±
            const container = document.getElementById('network');
            const data = { nodes, edges };
            const options = {
                layout: {
                    hierarchical: {
                        direction: 'LR',
                        sortMethod: 'directed',
                        levelSeparation: 200,
                        nodeSpacing: 100
                    }
                },
                physics: false,
                interaction: {
                    hover: true,
                    tooltipDelay: 200
                }
            };
            
            new vis.Network(container, data, options);
        }

        // íƒœìŠ¤í¬ ì¹´ë“œ ìƒì„±
        function createTaskCard(task, criticalPath) {
            const isIndependent = task.dependencies.length === 0;
            const isCritical = criticalPath.has(task.id);
            
            return `
                <div class="task-card border rounded-lg p-4 ${isCritical ? 'border-purple-500 bg-purple-50' : isIndependent ? 'border-green-500 bg-green-50' : 'border-blue-500 bg-blue-50'}">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="font-semibold text-lg">${task.name}</h3>
                        <span class="text-sm px-2 py-1 rounded ${isCritical ? 'bg-purple-200 text-purple-800' : isIndependent ? 'bg-green-200 text-green-800' : 'bg-blue-200 text-blue-800'}">
                            ${task.estimatedDays}ì¼
                        </span>
                    </div>
                    <p class="text-gray-600 text-sm mb-2">${task.description}</p>
                    ${task.dependencies.length > 0 ? `
                        <div class="text-sm text-gray-500">
                            <span class="font-medium">ì˜ì¡´ì„±:</span> ${task.dependencies.length}ê°œ
                        </div>
                    ` : '<div class="text-sm text-green-600 font-medium">ë…ë¦½ ì‹¤í–‰ ê°€ëŠ¥</div>'}
                </div>
            `;
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStats(tasks) {
            const totalTasks = tasks.length;
            const independentTasks = tasks.filter(t => t.dependencies.length === 0).length;
            const dependentTasks = totalTasks - independentTasks;
            const totalDays = Math.max(...tasks.map(t => t.estimatedDays));
            
            document.getElementById('totalTasks').textContent = totalTasks;
            document.getElementById('independentTasks').textContent = independentTasks;
            document.getElementById('dependentTasks').textContent = dependentTasks;
            document.getElementById('estimatedTime').textContent = `${totalDays}ì¼`;
        }

        // ì´ˆê¸°í™”
        async function init() {
            const tasks = await fetchTasks();
            const criticalPath = calculateCriticalPath(tasks);
            
            // í†µê³„ ì—…ë°ì´íŠ¸
            updateStats(tasks);
            
            // ë„¤íŠ¸ì›Œí¬ ê·¸ë˜í”„ ìƒì„±
            createNetworkGraph(tasks);
            
            // íƒœìŠ¤í¬ ëª©ë¡ ìƒì„±
            const taskListContainer = document.getElementById('taskList');
            taskListContainer.innerHTML = tasks.map(task => createTaskCard(task, criticalPath)).join('');
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        init();
    </script>
</body>
</html>