# 🐛 버그 추적 시스템 (Bug Tracker)

이 문서는 게임플라자 프로젝트에서 발견된 모든 버그와 수정 내역을 추적합니다.

## 📋 버그 템플릿

```markdown
### BUG-[번호]: [버그 제목]
- **발견일**: YYYY-MM-DD
- **심각도**: 🔴 Critical | 🟠 Major | 🟡 Minor | 🟢 Trivial
- **상태**: 🐛 Open | 🔧 In Progress | ✅ Fixed | ❌ Won't Fix
- **영향 범위**: [영향받는 기능/모듈]
- **발견자**: [사용자/개발자]
- **담당자**: [수정 담당자]

#### 증상
[버그의 구체적인 증상 설명]

#### 재현 방법
1. [단계별 재현 방법]
2. ...

#### 예상 동작
[정상적인 동작]

#### 실제 동작
[버그 발생 시 동작]

#### 원인 분석
[버그 발생 원인]

#### 수정 내용
- **수정일**: YYYY-MM-DD
- **수정 파일**: 
  - `path/to/file.ts`
- **커밋**: [커밋 해시]

#### 회귀 방지 대책
[이 버그가 재발하지 않도록 하는 방법]

#### 관련 버그
- [다른 관련 버그 번호]
```

## 🔴 Critical Bugs (서비스 중단급)

### BUG-001: 예약 목록 API 500 에러
- **발견일**: 2025-01-03
- **심각도**: 🔴 Critical
- **상태**: ✅ Fixed
- **영향 범위**: 예약 목록 조회 기능
- **발견자**: 사용자
- **담당자**: 개발팀

#### 증상
GET /api/reservations 호출 시 500 Internal Server Error 발생

#### 재현 방법
1. 예약 목록 페이지 접속
2. 즉시 500 에러 발생

#### 예상 동작
예약 목록이 정상적으로 표시됨

#### 실제 동작
"Cannot read property of undefined (reading 'user')" 에러 발생

#### 원인 분석
`session.user.id` 대신 undefined인 `user` 변수를 참조하여 발생

#### 수정 내용
- **수정일**: 2025-01-03
- **수정 파일**: 
  - `app/api/reservations/route.ts`
- **커밋**: [수정됨]

#### 회귀 방지 대책
- TypeScript strict mode 활성화
- undefined 체크 강화
- API 테스트 코드 작성

### BUG-007: payment_status 제약 조건 위반
- **발견일**: 2025-07-15
- **심각도**: 🔴 Critical
- **상태**: ✅ Fixed
- **영향 범위**: 체크인 프로세스
- **발견자**: 시스템
- **담당자**: 개발팀

#### 증상
체크인 시도 시 "check constraint 'reservations_payment_status_check' violated" 에러

#### 원인 분석
데이터베이스 제약 조건에 'completed', 'confirmed' 값이 없음

#### 수정 내용
- **수정일**: 2025-07-15
- **수정 파일**: 
  - Database migration via MCP
- **커밋**: MCP 실행

#### 회귀 방지 대책
- 데이터베이스 스키마 문서화 강화
- 마이그레이션 테스트 필수화

## 🟠 Major Bugs (주요 기능 오류)

### BUG-002: 예약 필터링 시 전체 개수 변경
- **발견일**: 2025-01-03
- **심각도**: 🟠 Major
- **상태**: ✅ Fixed
- **영향 범위**: 예약 목록 필터링
- **발견자**: 사용자
- **담당자**: 개발팀

#### 증상
필터링 적용 시 "전체" 탭의 개수가 함께 변경됨

#### 원인 분석
필터링된 데이터로 전체 개수를 계산하여 발생

#### 수정 내용
- **수정일**: 2025-01-03
- **수정 파일**: 
  - `app/reservations/page.tsx`
  - `app/admin/reservations/page.tsx`

#### 회귀 방지 대책
- 전체 데이터와 필터링 데이터 분리 관리
- 상태 관리 로직 개선

### BUG-003: 관리자 페이지 상단 고정 실패
- **발견일**: 2025-01-03
- **심각도**: 🟠 Major
- **상태**: ✅ Fixed
- **영향 범위**: 관리자 UI/UX
- **발견자**: 사용자
- **담당자**: 개발팀

#### 증상
관리자 예약 관리 페이지에서 스크롤 시 필터 탭이 고정되지 않음

#### 원인 분석
관리자 레이아웃의 overflow-y-auto 설정으로 sticky 동작 불가

#### 수정 내용
- **수정일**: 2025-01-03
- **수정 파일**: 
  - `app/admin/reservations/page.tsx`
  - `app/admin/layout.tsx`

### BUG-004: 기기 모델명/버전명 저장 실패
- **발견일**: 2025-07-04
- **심각도**: 🟠 Major
- **상태**: ✅ Fixed
- **영향 범위**: 기기 관리
- **발견자**: 사용자
- **담당자**: 개발팀

#### 증상
기기 관리에서 모델명/버전명이 저장되지 않음

#### 원인 분석
- supabaseAdmin 미사용으로 RLS 정책 차단
- Next.js 15의 params Promise 미처리

#### 수정 내용
- **수정일**: 2025-07-04
- **수정 파일**: 
  - `app/api/admin/device-types/[id]/route.ts`
  - `app/lib/supabase.ts`

### BUG-005: 예약 생성 시 기기 사용 불가 오류
- **발견일**: 2025-07-04
- **심각도**: 🟠 Major
- **상태**: ✅ Fixed
- **영향 범위**: 예약 생성
- **발견자**: 사용자
- **담당자**: 개발팀

#### 증상
예약 최종 처리 시 "선택한 기기를 사용할 수 없습니다" 오류

#### 원인 분석
device_number 필드 누락

#### 수정 내용
- **수정일**: 2025-07-04
- **수정 파일**: 
  - `app/reservations/new/page.tsx`

### BUG-006: 운영일정 수정 모달 미표시
- **발견일**: 2025-07-14
- **심각도**: 🟠 Major
- **상태**: ✅ Fixed
- **영향 범위**: 운영일정 관리
- **발견자**: 사용자
- **담당자**: 개발팀

#### 증상
운영일정 클릭 시 수정 모달이 표시되지 않음

#### 원인 분석
viewingEvent 상세보기 모달이 수정 기능 차단

#### 수정 내용
- **수정일**: 2025-07-14
- **수정 파일**: 
  - `app/admin/schedule/page.tsx`

### BUG-008: 마이페이지 예약 상태 표시 오류
- **발견일**: 2025-07-15
- **심각도**: 🟠 Major
- **상태**: ✅ Fixed
- **영향 범위**: 마이페이지
- **발견자**: 사용자
- **담당자**: 개발팀

#### 증상
승인된 예약이 "승인 대기"로 표시됨

#### 원인 분석
'approved' 상태와 'pending' 상태를 구분하지 않음

#### 수정 내용
- **수정일**: 2025-07-15
- **수정 파일**: 
  - `app/api/mypage/reservation-stats/route.ts`
  - `app/mypage/page.tsx`

## 🟡 Minor Bugs (사소한 오류)

### BUG-009: 밤샘 시간 표시 오류
- **발견일**: 2025-07-04
- **심각도**: 🟡 Minor
- **상태**: ✅ Fixed
- **영향 범위**: 일정 표시
- **발견자**: 사용자
- **담당자**: 개발팀

#### 증상
밤샘 영업 "08:00 ~ 05:00" 같은 이해할 수 없는 표시

#### 원인 분석
24시간 이후 시간을 일반 형식으로 표시

#### 수정 내용
- **수정일**: 2025-07-04
- **수정 파일**: 
  - `app/schedule/page.tsx` (formatTime24Plus 함수 추가)

### BUG-010: 체크인 페이지 모바일 레이아웃
- **발견일**: 2025-07-15
- **심각도**: 🟡 Minor
- **상태**: ✅ Fixed
- **영향 범위**: 모바일 UI
- **발견자**: 사용자
- **담당자**: 개발팀

#### 증상
모바일에서 모든 통계가 1열로 표시됨

#### 수정 내용
- **수정일**: 2025-07-15
- **수정 파일**: 
  - `app/admin/checkin/page.tsx`

## 🔍 버그 패턴 분석

### 자주 발생하는 버그 유형
1. **RLS (Row Level Security) 관련**
   - 원인: supabaseAdmin 미사용
   - 해결: 관리자 API에서는 supabaseAdmin 사용 필수

2. **시간대 처리**
   - 원인: UTC/KST 혼용
   - 해결: 모든 시간 처리를 KST로 통일

3. **상태 관리**
   - 원인: 클라이언트 상태와 서버 상태 불일치
   - 해결: 실시간 동기화 강화

4. **TypeScript 타입 오류**
   - 원인: undefined 체크 누락
   - 해결: strict mode 활성화 및 타입 가드 사용

## 📊 버그 통계

### 심각도별 분포
- 🔴 Critical: 2건 (모두 수정됨)
- 🟠 Major: 6건 (모두 수정됨)
- 🟡 Minor: 2건 (모두 수정됨)
- 🟢 Trivial: 0건

### 영향 범위별 분포
- 예약 시스템: 4건
- 관리자 기능: 3건
- UI/UX: 3건
- 인증/권한: 1건

## 🛡️ 회귀 방지 전략

### 1. 테스트 코드 작성
- 모든 버그 수정 시 테스트 케이스 추가
- Critical 버그는 E2E 테스트 필수

### 2. 코드 리뷰 강화
- TypeScript strict mode 활용
- RLS 정책 체크리스트
- 시간대 처리 가이드라인

### 3. 모니터링
- 에러 로깅 시스템 구축
- 사용자 피드백 채널 운영
- 정기적인 버그 분석 회의

## 📝 버그 리포트 가이드

### 버그 발견 시
1. 이 문서에서 중복 확인
2. 버그 템플릿에 따라 작성
3. 심각도 판단 기준:
   - Critical: 서비스 이용 불가
   - Major: 주요 기능 오류
   - Minor: 사용에 불편
   - Trivial: 미관상 문제

### 버그 수정 시
1. 원인 분석 상세 기록
2. 수정 내용과 파일 명시
3. 회귀 방지 대책 수립
4. 관련 테스트 코드 작성

---

마지막 업데이트: 2025-07-22