# 광주 게임플라자 대여가격 설정 시스템 기획서

## 개요
대여 가능한 리듬게임 기기의 시간대별 가격을 효율적으로 관리하는 시스템

## 최종 업데이트: 2025-06-27

## 주요 기능
1. **기기 분리 관리**: 일반 기기와 대여 기기를 별도 관리
2. **대여 가능 대수 설정**: 전체 보유 대수 중 동시 대여 가능한 대수 제한
3. **시간대별 가격 설정**: 조기/밤샘 대여 시간대와 가격 관리
4. **크레딧 옵션**: 고정크레딧/프리플레이/무한크레딧 선택
5. **2인 플레이 옵션**: 마이마이 2P 추가 요금 설정
6. **기종별 순서 설정**: 예약 현황 표시 순서 관리

## 핵심 변경사항 (2025.06.27)

### 시간대별 자동 가격 설정
- **기존**: 시간별로 개별 가격 설정 (4시간, 5시간, 6시간 각각 설정)
- **변경**: 시간대 설정시 자동으로 해당 시간 계산
  - 예시: 07:00~12:00 설정 → 자동으로 5시간으로 계산
  - 각 크레딧 옵션별로 해당 시간(5시간)에 대한 가격만 설정

### 시간대 구조
```typescript
interface TimeSlot {
  id: string;
  device_type_id: string;
  slot_type: 'early' | 'overnight';  // 조기대여 or 밤샘대여
  start_time: string;  // "07:00"
  end_time: string;    // "12:00" (밤샘의 경우 "05:00")
  credit_options: [
    {
      type: 'fixed',      // 고정크레딧
      price: 25000,       // 자동 계산된 시간 가격
      fixed_credits: 100  // 크레딧 수 (1단위로 설정 가능)
    },
    {
      type: 'freeplay',   // 프리플레이
      price: 30000        // 자동 계산된 시간 가격
    },
    {
      type: 'unlimited',  // 무한크레딧
      price: 35000        // 자동 계산된 시간 가격
    }
  ];
  enable_2p: boolean;     // 2인 플레이 가능 여부
  price_2p_extra?: number; // 2인 플레이 추가 요금
  is_youth_time?: boolean; // 청소년 시간대 여부
}
```

## 사용 시나리오

### 1. 조기대여 시간대 추가
1. 관리자가 "조기대여 추가" 클릭
2. 시간 설정: 07:00 ~ 12:00
3. 시스템이 자동으로 5시간 계산
4. 크레딧 옵션별 5시간 가격 입력:
   - 고정크레딧(100크레딧): 25,000원
   - 프리플레이: 30,000원
   - 무한크레딧: 35,000원
5. 2인 플레이 옵션 설정
6. 청소년 시간대 여부 체크

### 2. 밤샘대여 시간대 추가
1. 관리자가 "밤샘대여 추가" 클릭
2. 시간 설정: 22:00 ~ 05:00 (다음날 새벽)
   - 표시는 24~29시 형식으로 보여짐
3. 시스템이 자동으로 7시간 계산
4. 크레딧 옵션별 7시간 가격 입력:
   - 고정크레딧(150크레딧): 45,000원
   - 프리플레이: 55,000원
   - 무한크레딧: 65,000원

## 데이터베이스 구조

### rental_time_slots 테이블
```sql
CREATE TABLE rental_time_slots (
  id UUID PRIMARY KEY,
  device_type_id UUID REFERENCES device_types(id),
  slot_type TEXT CHECK (slot_type IN ('early', 'overnight')),
  start_time TIME NOT NULL,
  end_time TIME NOT NULL,
  credit_options JSONB NOT NULL,  -- 크레딧 타입별 가격 정보
  enable_2p BOOLEAN DEFAULT false,
  price_2p_extra INTEGER,
  is_youth_time BOOLEAN DEFAULT false,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);
```

## UI/UX 개선사항

### 시간대 추가 폼
1. **시간 입력**
   - 시작/종료 시간 선택
   - 자동으로 대여 시간 계산 및 표시
   
2. **가격 설정**
   - 계산된 시간에 대한 가격만 입력
   - 크레딧 타입별로 구분하여 표시
   - 고정크레딧의 경우 크레딧 수 설정 가능

3. **추가 옵션**
   - 2인 플레이 설정
   - 청소년 시간대 설정

### 시간대 목록 표시
- 조기대여와 밤샘대여 구분하여 표시
- 각 시간대별 크레딧 옵션과 가격 한눈에 확인
- 편집/삭제 기능
- 시간 표기: 24시간제 (09~13, 22~05 형식)
- 밤샘 시간: 24~29시로 표시

## 장점
1. **간편한 관리**: 시간대별로 한 번에 설정
2. **실수 방지**: 자동 시간 계산으로 오류 감소
3. **직관적 UI**: 시간대와 가격이 명확히 연결
4. **유연한 가격정책**: 시간대별로 다른 가격 전략 가능

## 주요 UI/UX 개선사항
1. **시간 선택 방식**: 조기/밤샘 모두 select dropdown 사용 (키보드 위아래 네비게이션)
2. **가격 단위**: 1,000원 단위로 설정 가능
3. **저장 버튼**: 대여 가능 대수 설정에 별도 저장 버튼 추가
4. **상태 표시**: 기기 목록에서 시간대 설정 상태 표시 (조기 N개, 밤샘 N개)
5. **기종별 색상 설정**: 캘린더 예약 현황 표시를 위한 색상 선택 기능
   - 9가지 기본 색상 팔레트 제공 (3x3 그리드)
   - 클릭으로 간단하게 색상 변경
   - 각 색상 버튼은 12x12 크기로 통일
   - 그리드 중앙 정렬 (`place-items-center`)로 깔끔한 배치
   - 선택된 색상은 파란색 테두리로 표시
   - 설정된 색상은 운영일정 캘린더에서 예약 구분에 사용
6. **기종별 표시 순서 관리**
   - 모바일: 각 기기 카드에 위/아래 화살표 버튼 제공
   - 데스크톱: 드래그 핸들(≡)을 통한 드래그 앤 드롭
   - 설정한 순서는 예약 현황 표시에 반영
   - 첫 번째/마지막 항목은 해당 방향 버튼 비활성화
   - 드래그 중인 항목은 반투명 처리
   - 드롭 위치는 파란색 테두리로 표시
   - 기기관리의 기종관리도 동일한 순서 관리 기능 적용

## 향후 개선사항
1. 요일별 가격 차등 설정
2. 특별 이벤트 기간 가격 설정
3. 시간대 템플릿 기능
4. 가격 변동 히스토리 관리